{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useEffect, useState } from 'react';\nimport ChildrenWrapper from \"./ChildrenWrapper\";\nimport wrapRootComponent from \"./wrapRootComponent\";\nvar siblingWrapper = function siblingWrapper(sibling) {\n  return sibling;\n};\nfunction renderSibling(sibling) {\n  return siblingWrapper(sibling);\n}\nexport function setSiblingWrapper(wrapper) {\n  siblingWrapper = wrapper;\n}\nvar _wrapRootComponent = wrapRootComponent(ChildrenWrapper, renderSibling),\n  defaultManager = _wrapRootComponent.manager;\nvar uuid = 0;\nvar managerStack = [defaultManager];\nvar inactiveManagers = new Set();\nfunction getActiveManager() {\n  for (var i = managerStack.length - 1; i >= 0; i--) {\n    var manager = managerStack[i];\n    if (!inactiveManagers.has(manager)) {\n      return manager;\n    }\n  }\n  return defaultManager;\n}\nvar RootSiblingsManager = function () {\n  function RootSiblingsManager(element, callback) {\n    _classCallCheck(this, RootSiblingsManager);\n    this.id = `root-sibling-${uuid + 1}`;\n    this.manager = getActiveManager();\n    this.manager.update(this.id, element, callback);\n    uuid++;\n  }\n  _createClass(RootSiblingsManager, [{\n    key: \"update\",\n    value: function update(element, callback) {\n      this.manager.update(this.id, element, callback);\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy(callback) {\n      this.manager.destroy(this.id, callback);\n    }\n  }]);\n  return RootSiblingsManager;\n}();\nexport { RootSiblingsManager as default };\nexport function RootSiblingParent(props) {\n  var inactive = props.inactive;\n  var _useState = useState(function () {\n      var _wrapRootComponent2 = wrapRootComponent(ChildrenWrapper, renderSibling),\n        parentRoot = _wrapRootComponent2.Root,\n        parentManager = _wrapRootComponent2.manager;\n      managerStack.push(parentManager);\n      if (inactive) {\n        inactiveManagers.add(parentManager);\n      }\n      return {\n        Root: parentRoot,\n        manager: parentManager\n      };\n    }),\n    _useState2 = _slicedToArray(_useState, 1),\n    sibling = _useState2[0];\n  useEffect(function () {\n    return function () {\n      if (sibling) {\n        var index = managerStack.indexOf(sibling.manager);\n        if (index > 0) {\n          managerStack.splice(index, 1);\n        }\n      }\n    };\n  }, [sibling]);\n  if (inactive && sibling && !inactiveManagers.has(sibling.manager)) {\n    inactiveManagers.add(sibling.manager);\n  } else if (!inactive && sibling && inactiveManagers.has(sibling.manager)) {\n    inactiveManagers.delete(sibling.manager);\n  }\n  var Parent = sibling.Root;\n  return _jsx(Parent, {\n    children: props.children\n  });\n}\nexport function RootSiblingPortal(props) {\n  var _useState3 = useState(function () {\n      return new RootSiblingsManager(null);\n    }),\n    _useState4 = _slicedToArray(_useState3, 1),\n    sibling = _useState4[0];\n  sibling.update(props.children);\n  useEffect(function () {\n    if (sibling) {\n      return function () {\n        return sibling.destroy();\n      };\n    }\n  }, [sibling]);\n  return null;\n}","map":{"version":3,"names":["useEffect","useState","ChildrenWrapper","wrapRootComponent","siblingWrapper","sibling","renderSibling","setSiblingWrapper","wrapper","_wrapRootComponent","defaultManager","manager","uuid","managerStack","inactiveManagers","Set","getActiveManager","i","length","has","RootSiblingsManager","element","callback","_classCallCheck","id","update","_createClass","key","value","destroy","default","RootSiblingParent","props","inactive","_useState","_wrapRootComponent2","parentRoot","Root","parentManager","push","add","_useState2","_slicedToArray","index","indexOf","splice","delete","Parent","_jsx","children","RootSiblingPortal","_useState3","_useState4"],"sources":["../src/RootSiblingsManager.tsx"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}