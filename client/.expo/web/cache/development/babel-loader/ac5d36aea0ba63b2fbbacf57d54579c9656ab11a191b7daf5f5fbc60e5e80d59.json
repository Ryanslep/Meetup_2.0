{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nimport { Fragment as _Fragment, jsxs as _jsxs, jsx as _jsx } from \"react/jsx-runtime\";\nimport { Component } from 'react';\nimport StaticContainer from \"./StaticContainer\";\nimport { RootControllerChanges } from \"./RootController\";\nvar _default = function (_Component) {\n  _inherits(_default, _Component);\n  var _super = _createSuper(_default);\n  function _default(props) {\n    var _this;\n    _classCallCheck(this, _default);\n    _this = _super.call(this, props);\n    _this.updatedSiblings = new Set();\n    _this.siblingsPool = [];\n    _this.state = {\n      siblings: []\n    };\n    return _this;\n  }\n  _createClass(_default, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n      this.props.controller.setCallback(function (id, change) {\n        setTimeout(function () {\n          return _this2.commitChange(id, change);\n        });\n      });\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      this.updatedSiblings.clear();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return _jsxs(_Fragment, {\n        children: [this.props.children, this.renderSiblings()]\n      });\n    }\n  }, {\n    key: \"commitChange\",\n    value: function commitChange(id, _ref) {\n      var _this3 = this;\n      var change = _ref.change,\n        element = _ref.element,\n        updateCallback = _ref.updateCallback;\n      var siblings = Array.from(this.siblingsPool);\n      var index = siblings.findIndex(function (sibling) {\n        return sibling.id === id;\n      });\n      if (change === RootControllerChanges.Remove) {\n        if (index > -1) {\n          siblings.splice(index, 1);\n        } else {\n          this.invokeCallback(updateCallback);\n          return;\n        }\n      } else if (change === RootControllerChanges.Update) {\n        if (index > -1) {\n          siblings.splice(index, 1, {\n            element: element,\n            id: id\n          });\n          this.updatedSiblings.add(id);\n        } else {\n          this.invokeCallback(updateCallback);\n          return;\n        }\n      } else {\n        if (index > -1) {\n          siblings.splice(index, 1);\n        }\n        siblings.push({\n          element: element,\n          id: id\n        });\n        this.updatedSiblings.add(id);\n      }\n      this.siblingsPool = siblings;\n      this.setState({\n        siblings: siblings\n      }, function () {\n        return _this3.invokeCallback(updateCallback);\n      });\n    }\n  }, {\n    key: \"invokeCallback\",\n    value: function invokeCallback(callback) {\n      if (callback) {\n        callback();\n      }\n    }\n  }, {\n    key: \"renderSiblings\",\n    value: function renderSiblings() {\n      var _this4 = this;\n      return this.state.siblings.map(function (_ref2) {\n        var id = _ref2.id,\n          element = _ref2.element;\n        return _jsx(StaticContainer, {\n          shouldUpdate: _this4.updatedSiblings.has(id),\n          children: _this4.wrapSibling(element)\n        }, `root-sibling-${id}`);\n      });\n    }\n  }, {\n    key: \"wrapSibling\",\n    value: function wrapSibling(element) {\n      var renderSibling = this.props.renderSibling;\n      if (renderSibling) {\n        return renderSibling(element);\n      } else {\n        return element;\n      }\n    }\n  }]);\n  return _default;\n}(Component);\nexport { _default as default };","map":{"version":3,"names":["Component","StaticContainer","RootControllerChanges","_default","_Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","updatedSiblings","Set","siblingsPool","state","siblings","_createClass","key","value","componentDidMount","_this2","controller","setCallback","id","change","setTimeout","commitChange","componentDidUpdate","clear","render","_jsxs","_Fragment","children","renderSiblings","_ref","_this3","element","updateCallback","Array","from","index","findIndex","sibling","Remove","splice","invokeCallback","Update","add","push","setState","callback","_this4","map","_ref2","_jsx","shouldUpdate","has","wrapSibling","renderSibling","default"],"sources":["../src/RootSiblings.tsx"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}